# éƒ¨ç½²å¿«é€Ÿå‚è€ƒå¡

## ğŸ¯ å•åŸŸåéƒ¨ç½²æ¶æ„

```
www.example.com
â”œâ”€â”€ /              â†’ ç”¨æˆ·ç«¯ (Frontend-A)
â”œâ”€â”€ /admin/        â†’ ç®¡ç†ç«¯ (Frontend-B)
â”œâ”€â”€ /verify/       â†’ æ ¸é”€ç«¯ (Frontend-C)
â””â”€â”€ /api/          â†’ åç«¯API
```

---

## âš¡ å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

### 1. æœ¬åœ°æ„å»ºï¼ˆåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼‰

```bash
# æ„å»ºæ‰€æœ‰å‰ç«¯
cd frontend-a && npm install && npm run build && cd ..
cd frontend-b && npm install && npm run build && cd ..
cd frontend-c && npm install && npm run build && cd ..

# æ‰“åŒ…åç«¯
cd shared-backend && mvn clean package -DskipTests && cd ..
```

### 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨

ä¸Šä¼ ä»¥ä¸‹å†…å®¹åˆ°æœåŠ¡å™¨ï¼š

```
/www/wwwroot/buyticket/
â”œâ”€â”€ frontend-a/  â† ä¸Šä¼  frontend-a/dist/* çš„å†…å®¹
â”œâ”€â”€ frontend-b/  â† ä¸Šä¼  frontend-b/dist/* çš„å†…å®¹
â””â”€â”€ frontend-c/  â† ä¸Šä¼  frontend-c/dist/* çš„å†…å®¹
```

---

## ğŸ“ å…³é”®é…ç½®

### Vite é…ç½®ï¼ˆå·²å®Œæˆï¼‰

| é¡¹ç›® | base è·¯å¾„ | ç«¯å£ |
|------|-----------|------|
| frontend-a | `/` | 5173 |
| frontend-b | `/admin/` | 3001 |
| frontend-c | `/verify/` | 5174 |

### API é…ç½®ï¼ˆå·²å®Œæˆï¼‰

| é¡¹ç›® | baseURL |
|------|---------|
| frontend-a | `/api/v1` |
| frontend-b | `/api/v1` |
| frontend-c | `/api/v1/admin` |

### åç«¯é…ç½®ï¼ˆéœ€è¦ä¿®æ”¹ï¼‰

```yaml
# application.yml
alipay:
  notify-url: https://ä½ çš„åŸŸå/api/v1/payment/alipay/notify
  return-url: https://ä½ çš„åŸŸå/order-success
```

---

## ğŸ”§ Nginx é…ç½®è¦ç‚¹

```nginx
# ç”¨æˆ·ç«¯ï¼ˆæ ¹è·¯å¾„ï¼‰
location / {
    root /www/wwwroot/buyticket/frontend-a;
    try_files $uri $uri/ /index.html;
}

# ç®¡ç†ç«¯
location /admin {
    alias /www/wwwroot/buyticket/frontend-b;
    try_files $uri $uri/ /admin/index.html;
}

# æ ¸é”€ç«¯
location /verify {
    alias /www/wwwroot/buyticket/frontend-c;
    try_files $uri $uri/ /verify/index.html;
}

# API ä»£ç†
location /api/ {
    proxy_pass http://127.0.0.1:8080;
}
```

---

## âœ… æµ‹è¯•æ¸…å•

è®¿é—®ä»¥ä¸‹åœ°å€éªŒè¯éƒ¨ç½²ï¼š

- [ ] `https://ä½ çš„åŸŸå/` - ç”¨æˆ·ç«¯é¦–é¡µ
- [ ] `https://ä½ çš„åŸŸå/admin/` - ç®¡ç†ç«¯ç™»å½•é¡µ
- [ ] `https://ä½ çš„åŸŸå/verify/` - æ ¸é”€ç«¯ç™»å½•é¡µ
- [ ] `https://ä½ çš„åŸŸå/api/v1/exhibition/list` - API æµ‹è¯•

---

## ğŸš¨ å¸¸è§é—®é¢˜é€ŸæŸ¥

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| 404 é”™è¯¯ | Nginx é…ç½®é”™è¯¯ | æ£€æŸ¥ `try_files` é…ç½® |
| é™æ€èµ„æº 404 | base è·¯å¾„é”™è¯¯ | é‡æ–°æ„å»ºå‰ç«¯ |
| API è¯·æ±‚å¤±è´¥ | åç«¯æœªå¯åŠ¨ | æ£€æŸ¥åç«¯æœåŠ¡ (8080ç«¯å£) |
| é¡µé¢åˆ·æ–° 404 | è·¯ç”±é…ç½®é—®é¢˜ | æ£€æŸ¥ Nginx `try_files` |

---

## ğŸ“‚ æ–‡ä»¶è·¯å¾„é€ŸæŸ¥

| æ–‡ä»¶ | è·¯å¾„ |
|------|------|
| Nginx é…ç½® | å®å¡”é¢æ¿ â†’ ç½‘ç«™ â†’ è®¾ç½® â†’ é…ç½®æ–‡ä»¶ |
| åç«¯é…ç½® | `shared-backend/src/main/resources/application.yml` |
| Nginx æ—¥å¿— | `/www/wwwlogs/buyticket_error.log` |
| åç«¯æ—¥å¿— | `/www/wwwroot/logs/buyticket/application.log` |

---

## ğŸ¯ éƒ¨ç½²æµç¨‹å›¾

```
1. æœ¬åœ°æ„å»º
   â†“
2. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
   â†“
3. é…ç½® Nginx
   â†“
4. ä¿®æ”¹åç«¯é…ç½®
   â†“
5. å¯åŠ¨åç«¯æœåŠ¡
   â†“
6. é…ç½® SSLï¼ˆå¯é€‰ï¼‰
   â†“
7. æµ‹è¯•éªŒè¯
   â†“
8. å®Œæˆ âœ…
```

---

## ğŸ’¡ æç¤º

- æ‰€æœ‰é…ç½®æ–‡ä»¶å·²è‡ªåŠ¨ä¿®æ”¹å®Œæˆ
- åªéœ€è¦æ„å»ºã€ä¸Šä¼ ã€é…ç½® Nginx
- è®°å¾—ä¿®æ”¹åç«¯é…ç½®ä¸­çš„åŸŸå
- å»ºè®®å¼€å¯ HTTPS
- å®šæœŸå¤‡ä»½æ•°æ®åº“

---

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ï¼š
- ğŸ“˜ `å•åŸŸåéƒ¨ç½²æ“ä½œæŒ‡å—.md` - å®Œæ•´éƒ¨ç½²æ­¥éª¤
- ğŸ“— `SINGLE_DOMAIN_DEPLOYMENT.md` - æŠ€æœ¯è¯¦ç»†è¯´æ˜
- ğŸ“• `å®å¡”é¢æ¿éƒ¨ç½²å®Œæ•´æŒ‡å—.md` - å®å¡”é¢æ¿ä½¿ç”¨æŒ‡å—
