# 立即重启后端服务

## 当前问题
图表显示了数据点，但鼠标悬停时显示值为 0。这说明：
- ✅ 前端代码正确
- ✅ API调用正常
- ❌ **后端没有重启，新的统计接口没有生效**

## 立即执行以下步骤

### 1. 找到后端运行的终端窗口
如果后端正在运行，你应该能看到类似这样的输出：
```
Started Application in X.XXX seconds
```

### 2. 停止后端服务
在该终端窗口按 `Ctrl + C`

### 3. 重新启动后端

#### 方法A：使用IDEA（最简单）
1. 打开IDEA
2. 找到 `shared-backend` 项目
3. 找到主类（通常是 `Application.java` 或 `BuyTicketApplication.java`）
4. 右键点击该文件
5. 选择 "Run" 或 "Debug"
6. 等待启动完成

#### 方法B：使用命令行
打开新的终端窗口：
```bash
cd shared-backend
mvn clean spring-boot:run
```

### 4. 等待启动完成
你应该看到类似输出：
```
2026-01-31 XX:XX:XX.XXX  INFO XXXXX --- [main] c.b.Application : Started Application in 5.123 seconds
```

### 5. 测试API是否正常
打开新的终端窗口运行：
```bash
curl http://localhost:8080/api/v1/admin/statistics/dashboard
```

应该返回类似：
```json
{
  "code": 0,
  "data": {
    "todayTicketOrders": 0,
    "todayVerified": 3,
    "totalTicketOrders": 16,
    "userGrowth": [
      {"date": "2026-01-25", "value": 1},
      {"date": "2026-01-26", "value": 2},
      ...
    ],
    ...
  },
  "msg": "success"
}
```

### 6. 刷新浏览器
1. 打开浏览器的Dashboard页面
2. 按 `F5` 刷新
3. 打开开发者工具（F12）
4. 查看Console标签，应该看到：
   ```
   Dashboard API返回数据: {todayTicketOrders: 0, todayVerified: 3, ...}
   ```

### 7. 检查图表
现在鼠标悬停在图表上，应该显示真实的数值，而不是0。

## 如果还是0

### 检查1：确认后端真的重启了
```bash
# 检查8080端口是否有进程
netstat -ano | findstr :8080
```

### 检查2：查看浏览器控制台
按F12，查看Console标签的日志输出，看看API返回了什么数据。

### 检查3：直接访问API
在浏览器地址栏输入：
```
http://localhost:8080/api/v1/admin/statistics/dashboard
```
看看返回的JSON数据。

### 检查4：查看数据库
运行 `CHECK_DASHBOARD_DATA.sql` 确认数据库中确实有数据。

## 常见错误

### 错误1：端口被占用
```
Port 8080 is already in use
```
**解决**：找到占用8080端口的进程并关闭：
```bash
netstat -ano | findstr :8080
taskkill /PID <进程ID> /F
```

### 错误2：编译错误
```
[ERROR] Failed to execute goal
```
**解决**：检查代码是否有语法错误，运行：
```bash
cd shared-backend
mvn clean compile
```

### 错误3：数据库连接失败
```
Could not connect to database
```
**解决**：确认MySQL正在运行，检查 `application.yml` 中的数据库配置。

## 验证成功的标志

- [ ] 后端启动成功，看到 "Started Application" 日志
- [ ] curl测试返回正确的JSON数据
- [ ] 浏览器控制台显示正确的API数据
- [ ] Dashboard显示 "今日核销门票: 3张"
- [ ] 图表鼠标悬停显示真实数值（不是0）
- [ ] 用户增长趋势图显示累计用户数
- [ ] 订单趋势图显示每日订单数
- [ ] 销售趋势图显示每日销售额

## 紧急提示

**如果你没有重启后端，任何前端的修改都不会让数据显示正确！**

新的 `AdminStatisticsController` 只有在后端重启后才会加载到内存中。
