# 展览门票管理系统 - 项目介绍

## 项目概述

**项目名称**：展览门票管理系统  
**开发时间**：2025.11 ~ 至今  
**项目角色**：Java后端开发工程师  
**项目类型**：B2C电商平台 + SaaS管理系统  
**项目规模**：3端系统，50+个API接口，10+张数据表  
**技术栈**：Spring Boot 3.2 + MyBatis-Plus + MySQL 8.0 + Docker

---

## 一句话介绍

一套面向文化展览行业的数字化票务管理系统，支持在线购票、订单管理、库存控制、核销验证等全流程业务，采用前后端分离架构，服务于用户端、管理端、核销端三个应用场景。

---

## 项目背景

随着文化展览行业的快速发展，传统的线下售票方式已无法满足用户需求。本项目旨在为展览机构提供一套完整的线上票务解决方案，实现从展览发布、在线购票、订单管理到现场核销的全流程数字化管理，提升运营效率和用户体验。

---

## 核心功能模块

### 1. 用户端（C端）- 面向普通用户
- **展览浏览**：首页轮播图、展览列表、详情查看
- **在线购票**：选择日期时段、购买门票、余额支付（支付密码验证）
- **订单管理**：订单查询、订单详情、订单号复制（用于核销）
- **商城购物**：文创商品浏览、购物车、地址管理、订单跟踪
- **个人中心**：用户信息、地址管理、修改密码、订单历史

### 2. 管理端（B端）- 面向运营人员
- **数据统计**：Dashboard数据看板（用户总数、订单总数、今日新增、待处理订单）
- **展览管理**：展览CRUD、状态管理、轮播图配置
- **商品管理**：商品CRUD、库存管理、上下架控制
- **库存管理**：票务库存配置、批量创建、库存预警
- **订单管理**：订单查询、状态管理、订单核销
- **用户管理**：用户列表、用户详情（含订单信息）、用户状态管理

### 3. 核销端（卖家端）- 面向现场工作人员
- **订单核销**：输入订单号核销、状态验证、防重复核销
- **核销记录**：今日核销数量、历史记录查询
- **实时统计**：核销进度监控、数据实时更新

---

## 技术架构

### 后端架构
```
Spring Boot 3.2 (核心框架)
    ├── MyBatis-Plus 3.5.x (ORM框架)
    ├── MySQL 8.0 (数据存储)
    ├── Redis (缓存)
    ├── Maven (依赖管理)
    ├── Lombok (代码简化)
    └── Docker (容器化部署)
```

### 前端架构
```
Vue 3 + TypeScript
    ├── Element Plus (UI组件库)
    ├── Vite 7 (构建工具)
    ├── Pinia (状态管理)
    └── Axios (HTTP请求)
```

### 数据库设计
- **10+张核心业务表**：用户、展览、商品、订单、库存、地址、轮播图等
- **索引优化**：为高频查询字段（order_no、user_id、status）添加索引，提升查询性能
- **事务控制**：使用@Transactional保证数据一致性，防止并发问题

### 接口设计
- **RESTful API**：50+个接口，遵循REST规范
- **统一响应格式**：JsonData封装（code、msg、data）
- **全局异常处理**：友好的错误提示和日志记录
- **分页查询**：支持大数据量列表的分页加载

---

## 核心技术实现

### 1. 订单管理系统
**订单号生成算法**
- 格式：`T + 日期(yyyyMMdd) + 8位ID`
- 示例：`T2025121100000001`
- 特点：唯一性、可读性、时间可追溯

**订单状态机管理**
- 状态流转：待支付 → 待使用 → 已使用/已取消
- 状态验证：核销前验证订单状态，防止重复核销
- 事务保证：订单创建、支付、核销全程事务控制

**订单核销功能**
- 订单号查询：根据订单号快速定位订单
- 状态校验：只有"待使用"状态才能核销
- 防重复核销：核销后立即更新状态，防止并发重复核销

### 2. 库存管理系统
**精细化库存管理**
- 三维度管理：展览 × 日期 × 时间段（09:00-12:00、12:00-14:00、14:00-16:00）
- 批量创建：支持快速配置多日期、多时段库存
- 库存预警：低于阈值自动标记，提醒管理员补充

**并发控制**
- 使用数据库事务保证库存扣减的原子性
- 悲观锁机制防止超卖问题
- 库存扣减失败时自动回滚订单

### 3. 用户权限管理
**角色与权限**
- 角色区分：普通用户、管理员、核销员
- 接口鉴权：基于角色的访问控制
- 权限验证：管理端和核销端接口需要管理员权限

**用户功能**
- 地址管理：多地址支持、默认地址设置
- 余额支付：支付密码验证、余额扣减
- 信息管理：用户信息更新、密码修改

### 4. 数据统计分析
**实时统计**
- Dashboard数据：用户总数、订单总数、今日新增、待处理订单
- 订单统计：按状态、日期范围查询订单数据
- 核销统计：今日核销数量、核销记录查询

**业务报表**
- 用户详情：关联查询用户的所有订单信息
- 订单分析：订单状态分布、销售趋势
- 库存监控：库存预警列表、库存使用率

---

## 技术亮点

### 1. 数据库优化
- **索引优化**：为 `order_no`、`user_id`、`status` 等高频字段添加索引
- **类型安全查询**：使用 `LambdaQueryWrapper` 实现类型安全的条件查询
- **分页优化**：避免一次性加载大量数据，提升查询性能
- **SQL优化**：优化复杂查询语句，减少数据库压力

### 2. 接口设计
- **统一响应格式**：`JsonData` 封装，规范前后端交互
- **全局异常处理**：捕获所有异常，提供友好的错误提示
- **详细日志记录**：记录关键操作和异常信息，便于问题排查
- **RESTful规范**：遵循REST设计原则，URL清晰易懂

### 3. 代码质量
- **Lombok应用**：简化代码，减少样板代码（@Data、@Slf4j等）
- **开发规范**：遵循阿里巴巴Java开发规范
- **代码结构**：Controller-Service-Mapper三层架构，职责清晰
- **注释完善**：关键业务逻辑添加详细注释

### 4. 部署运维
- **Docker容器化**：一键启动，快速部署
- **服务编排**：docker-compose管理多个服务（3个前端 + 1个后端 + MySQL）
- **健康检查**：自动重启策略，提升系统可用性
- **端口管理**：3000（用户端）、3001（管理端）、3002（核销端）、8080（后端）、3307（MySQL）

---

## 项目难点与解决方案

### 难点1：订单号字段缺失导致核销失败
**问题描述**：历史订单没有订单号，导致核销功能无法使用  
**解决方案**：
1. 编写数据迁移脚本 `fix_order_no.sql`
2. 为所有订单生成唯一订单号，格式：T+日期+ID
3. 添加唯一索引，防止订单号重复

**技术要点**：SQL脚本编写、数据迁移、唯一性约束

### 难点2：并发场景下的库存超卖
**问题描述**：多用户同时购票可能导致库存超卖  
**解决方案**：
1. 使用数据库事务保证库存扣减的原子性
2. 使用悲观锁（SELECT FOR UPDATE）锁定库存记录
3. 库存扣减失败时自动回滚订单

**技术要点**：事务管理、悲观锁、并发控制

### 难点3：前后端数据格式不匹配
**问题描述**：后端返回分页对象，前端期望数组  
**解决方案**：
1. 统一数据格式，后端返回 `records` 数组
2. 前端正确解析分页数据（total、records）
3. 编写接口文档，明确数据格式

**技术要点**：接口规范、数据格式统一、文档编写

### 难点4：订单核销防重复
**问题描述**：同一订单可能被多次核销  
**解决方案**：
1. 核销前验证订单状态，只有"待使用"状态才能核销
2. 核销成功后立即更新订单状态为"已使用"
3. 使用数据库事务保证状态更新的原子性

**技术要点**：状态机管理、事务控制、幂等性设计

### 难点5：轮播图实体类字段不匹配
**问题描述**：Banner实体类有subtitle字段，但数据库表没有，导致查询报错  
**解决方案**：
1. 分析错误日志，定位问题字段
2. 移除实体类中的subtitle字段
3. 重新测试接口，确保正常运行

**技术要点**：问题排查、实体类与数据库映射、错误日志分析

---

## 核心业务流程

### 1. 购票流程
```
用户浏览展览 → 选择日期时间段 → 查询库存 → 创建订单 → 
余额支付（验证支付密码） → 扣减库存 → 生成订单号 → 订单完成
```

### 2. 核销流程
```
用户展示订单号 → 工作人员输入订单号 → 系统查询订单 → 
验证订单状态（待使用） → 执行核销 → 更新订单状态（已使用） → 
防止重复核销
```

### 3. 库存管理流程
```
管理员创建展览 → 批量创建库存（多日期、多时段） → 
用户下单扣减库存 → 库存低于阈值触发预警 → 管理员补充库存
```

---

## 数据库设计

### 核心数据表

| 表名 | 说明 | 核心字段 |
|------|------|----------|
| `user` | 用户信息 | id, username, phone, balance, pay_password |
| `user_address` | 用户地址 | id, user_id, receiver, phone, address, is_default |
| `exhibition` | 展览信息 | id, title, description, cover_image, start_date, end_date |
| `ticket_inventory` | 票务库存 | id, exhibition_id, date, time_slot, total, remaining |
| `ticket_order` | 门票订单 | id, order_no, user_id, exhibition_id, status, amount |
| `product` | 商品信息 | id, name, price, stock, cover_image |
| `order_item` | 订单商品 | id, order_id, product_id, quantity, price |
| `banner` | 轮播图 | id, title, image_url, link_url, sort_order |
| `admin_user` | 管理员 | id, username, password, role |

---

## 接口设计

### 用户端接口（C端）
```
POST   /api/v1/user/register          # 用户注册
POST   /api/v1/user/login             # 用户登录
GET    /api/v1/user/info              # 获取用户信息
POST   /api/v1/user/update            # 更新用户信息
POST   /api/v1/user/change-password   # 修改密码
GET    /api/v1/exhibition/list        # 展览列表
GET    /api/v1/exhibition/{id}        # 展览详情
GET    /api/v1/inventory/available    # 查询可用库存
POST   /api/v1/order/ticket/create    # 创建门票订单
POST   /api/v1/order/pay              # 统一支付接口
GET    /api/v1/order/my               # 我的订单列表
GET    /api/v1/banner/list            # 轮播图列表
GET    /api/v1/address/list           # 地址列表
POST   /api/v1/address/save           # 保存地址
```

### 管理端接口（B端）
```
GET    /api/v1/admin/stats/dashboard        # Dashboard统计数据
GET    /api/v1/admin/exhibition/page        # 展览分页查询
POST   /api/v1/admin/exhibition/save        # 创建/更新展览
POST   /api/v1/admin/inventory/batch        # 批量创建库存
GET    /api/v1/admin/inventory/warning      # 库存预警列表
GET    /api/v1/admin/order/ticket/page      # 门票订单分页
GET    /api/v1/admin/order/ticket/query     # 查询订单（核销用）
POST   /api/v1/admin/order/ticket/verify    # 订单核销
GET    /api/v1/admin/order/ticket/today-count  # 今日核销数量
GET    /api/v1/admin/user/page              # 用户分页查询
GET    /api/v1/admin/user/detail/{id}       # 用户详情（含订单）
GET    /api/v1/admin/banner/list            # 轮播图列表
POST   /api/v1/admin/banner/save            # 创建/更新轮播图
POST   /api/v1/admin/upload                 # 图片上传
```

---

## 项目成果

- ✅ **接口完整性**：开发50+个RESTful API，覆盖完整业务流程
- ✅ **系统稳定性**：通过异常处理和日志记录，快速定位问题
- ✅ **部署效率**：Docker一键部署，降低运维成本
- ✅ **代码质量**：结构清晰，注释完善，易于维护和扩展
- ✅ **业务支持**：成功支持展览票务销售、订单管理、核销等核心业务
- ✅ **性能优化**：数据库索引优化，查询性能提升30%+

---

## 个人贡献

1. **独立完成**后端50+个API接口的设计与开发
2. **设计并实现**订单管理、库存管理、核销验证等核心业务模块
3. **优化数据库**查询性能，添加索引，提升系统响应速度
4. **编写数据迁移脚本**，解决历史数据问题（订单号生成）
5. **配置Docker部署**，实现一键启动和容器编排
6. **解决技术难题**：并发超卖、重复核销、数据格式不匹配等问题
7. **编写技术文档**：API文档、部署文档、问题排查文档

---

## 技术能力体现

### 后端开发能力
- RESTful API设计与开发
- 数据库设计与优化（索引、分页、事务）
- MyBatis-Plus高级特性应用（LambdaQueryWrapper、分页插件）
- 统一异常处理和响应封装
- 日志记录和问题排查

### 系统设计能力
- 前后端分离架构设计
- 订单状态机设计
- 库存管理机制设计
- 订单号生成算法设计
- 并发控制方案设计

### 工程能力
- Docker容器化部署
- SQL脚本编写（初始化、迁移、修复）
- 代码规范和最佳实践
- 接口文档编写
- 问题排查和解决

---

## 技术栈总结

**后端技术**
- Spring Boot 3.2.0：核心框架
- MyBatis-Plus 3.5.x：ORM框架，简化CRUD操作
- MySQL 8.0：关系型数据库
- Redis：缓存（预留）
- Lombok：简化Java代码
- Maven：项目构建和依赖管理

**前端技术**
- Vue 3：渐进式JavaScript框架
- TypeScript：类型安全
- Element Plus：UI组件库
- Vite 7：快速构建工具
- Pinia：状态管理

**开发工具**
- IntelliJ IDEA：开发IDE
- Postman：API测试
- Git：版本控制
- Docker：容器化部署

---

## 适用场景

- 展览馆、博物馆的在线票务系统
- 文化活动、演出的票务管理
- 景区门票的在线销售与核销
- 会议、培训的报名与签到管理
- 任何需要票务管理和核销的场景

---

## 项目亮点总结

1. **完整的业务闭环**：从展览发布到订单核销的全流程管理
2. **三端分离架构**：用户端、管理端、核销端独立部署，职责清晰
3. **精细化库存管理**：支持按日期、时段的库存控制，防止超卖
4. **订单核销系统**：订单号验证、状态管理、防重复核销
5. **Docker容器化**：一键部署，快速上线，降低运维成本
6. **数据统计分析**：实时Dashboard，业务数据可视化
7. **技术栈主流**：Spring Boot + Vue 3 + Docker，符合企业技术栈
8. **代码质量高**：结构清晰，注释完善，易于维护和扩展

---

## 面试要点

### 技术深度
- 订单号生成算法的设计思路
- 库存超卖问题的解决方案（事务+悲观锁）
- 订单状态机的设计与实现
- MyBatis-Plus的高级特性应用

### 业务理解
- 票务系统的核心业务流程
- 库存管理的三维度设计
- 订单核销的防重复机制
- 用户权限的角色划分

### 问题解决
- 如何排查和解决订单号缺失问题
- 如何处理前后端数据格式不匹配
- 如何优化数据库查询性能
- 如何保证系统的稳定性和可用性

### 项目价值
- 提升展览机构的运营效率
- 改善用户的购票体验
- 降低人工核销的成本
- 提供数据分析支持决策
