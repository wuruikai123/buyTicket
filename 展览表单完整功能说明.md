# 展览表单完整功能说明

## 修改概述

根据需求完成了展览表单的优化：

1. ✅ 删除了"详情图"字段
2. ✅ 添加了"每小时门票数量"设置
3. ✅ 介绍插图改为大图显示（560x400px）
4. ✅ 所有图片都支持删除功能（悬停显示X按钮）

---

## 一、表单字段说明

### 1. 封面图（必填）

**用途：** 在A端列表页显示

**尺寸：** 200x200px（正方形）

**功能：**
- 点击+号上传图片
- 鼠标悬停显示删除按钮
- 点击X删除图片

### 2. 门票价格（必填）

**用途：** 设置展览门票的基础价格

**格式：** 数字，保留2位小数

**单位：** 元/人次

**范围：** 最小0元

### 3. 每小时门票数量（必填）

**用途：** 设置每个时间段可售门票数量

**格式：** 整数

**范围：** 1-10000

**默认值：** 100

**说明：** 
- 用于库存管理
- 控制每小时最多可售门票数
- 防止超卖

### 4. 展览名称（必填）

**用途：** 展览的标题

**示例：** "逐梦星辰：中国航天成就展"

### 5. 开始时间 / 结束时间（必填）

**用途：** 展览的展期

**格式：** 日期选择器

**说明：** 
- 系统会根据当前日期自动判断展览状态
- 待开始、进行中、已结束

### 6. 展览副标题（必填）

**用途：** 展览的简短描述

**示例：** "探索宇宙奥秘，感受航天魅力"

### 7. 展览介绍（必填）

**用途：** 展览的详细介绍

**格式：** 多行文本

**建议：** 200-500字

### 8. 介绍插图（可选）

**用途：** 在A端详情页展示展览相关图片

**尺寸：** 560x400px（横向矩形）

**数量：** 最多6张

**功能：**
- 点击+号上传图片
- 鼠标悬停显示删除按钮
- 点击X删除图片
- 每张图片独立管理

---

## 二、图片上传规范

### 封面图

**推荐尺寸：** 至少 400x400px

**推荐比例：** 1:1（正方形）

**用途：**
- A端首页展览列表
- A端近期展览列表
- 搜索结果展示

### 介绍插图

**推荐尺寸：** 至少 1120x800px

**推荐比例：** 7:5（横向矩形）

**用途：**
- A端展览详情页
- 展示展览现场、展品、环境等

**建议内容：**
1. 展览现场照片
2. 重点展品特写
3. 展厅环境
4. 互动体验区
5. 观众参观场景
6. 展览亮点

---

## 三、门票数量管理

### 每小时门票数量的作用

**库存控制：**
- 系统会根据这个数量生成每个时间段的库存
- 例如：设置100张/小时，则每个时间段最多可售100张

**时间段划分：**
- 9:00-10:00
- 10:00-11:00
- 11:00-12:00
- 13:00-14:00
- 14:00-15:00
- 15:00-16:00
- 16:00-17:00

**库存生成：**
- 保存展览后，需要在"门票管理 > 库存管理"中批量生成库存
- 选择日期范围和时间段
- 系统会自动创建库存记录

### 设置建议

**小型展览：** 50-100张/小时

**中型展览：** 100-300张/小时

**大型展览：** 300-1000张/小时

**特殊展览：** 根据实际场地容量设置

---

## 四、操作流程

### 创建新展览

1. **进入创建页面**
   - 点击侧边栏"展览管理 > 创建展览"
   - 或在展览列表点击"创建展览"按钮

2. **上传封面图**
   - 点击封面图的+号
   - 选择图片文件
   - 图片会自动显示

3. **填写基本信息**
   - 展览名称
   - 开始时间、结束时间
   - 展览副标题
   - 展览介绍

4. **设置价格和数量**
   - 门票价格（元/人次）
   - 每小时门票数量

5. **上传介绍插图（可选）**
   - 点击任意一个+号框
   - 选择图片文件
   - 可以上传1-6张图片

6. **保存展览**
   - 点击底部"保存"按钮
   - 系统验证必填字段
   - 保存成功后跳转到展览列表

7. **生成库存**
   - 进入"门票管理 > 库存管理"
   - 点击"批量生成库存"
   - 选择展览、日期范围、时间段
   - 系统自动生成库存记录

### 编辑展览

1. **进入编辑页面**
   - 在展览列表点击"详情"按钮
   - 系统自动加载展览信息

2. **修改信息**
   - 可以修改任何字段
   - 可以删除已上传的图片
   - 可以重新上传图片

3. **保存修改**
   - 点击"保存"按钮
   - 修改立即生效

### 删除图片

1. **鼠标悬停在图片上**
   - 会出现半透明黑色遮罩
   - 中间显示X图标

2. **点击X图标**
   - 图片被删除
   - 该位置恢复为+号状态

3. **重新上传**
   - 点击+号可以重新上传图片

---

## 五、A端展示效果

### 列表页

**显示内容：**
- 封面图（200x200px）
- 展览名称
- 展览副标题
- 门票价格
- 展览状态（进行中/待开始）

**点击效果：**
- 跳转到展览详情页

### 详情页

**顶部区域：**
- 封面图（大图显示）
- 展览名称
- 展览副标题
- 展览时间
- 门票价格

**介绍区域：**
- 展览介绍文字
- 介绍插图（如果有上传）
- 图片按上传顺序显示

**购票区域：**
- 选择日期
- 选择时间段
- 显示剩余票数
- 购买按钮

---

## 六、数据库变更

### 新增字段

**表名：** `exhibition`

**字段名：** `tickets_per_hour`

**类型：** INT

**默认值：** 100

**说明：** 每小时门票数量

### 迁移脚本

**文件：** `ADD_TICKETS_PER_HOUR_COLUMN.sql`

**执行命令：**
```bash
mysql -u root -p buyticket < ADD_TICKETS_PER_HOUR_COLUMN.sql
```

---

## 七、修改的文件列表

### 前端文件

1. `frontend-b/src/views/exhibition/ExhibitionForm.vue`
   - 删除详情图字段
   - 添加每小时门票数量字段
   - 介绍插图改为大图显示（560x400px）
   - 优化图片删除功能

### 后端文件

1. `shared-backend/src/main/java/com/buyticket/entity/Exhibition.java`
   - 添加 `ticketsPerHour` 字段

### 数据库文件

1. `ADD_TICKETS_PER_HOUR_COLUMN.sql`
   - 添加 `tickets_per_hour` 字段

---

## 八、测试清单

### 功能测试

- [ ] 封面图上传正常
- [ ] 封面图删除正常
- [ ] 介绍插图上传正常（6个位置）
- [ ] 介绍插图删除正常
- [ ] 每小时门票数量输入正常
- [ ] 每小时门票数量验证正常（1-10000）
- [ ] 保存展览成功
- [ ] 编辑展览加载数据正常
- [ ] 编辑展览保存成功

### 样式测试

- [ ] 封面图显示为200x200正方形
- [ ] 介绍插图显示为560x400矩形
- [ ] 图片悬停效果正常（遮罩和X图标）
- [ ] 边框样式正确（虚线）
- [ ] 悬停时边框变蓝色

### A端展示测试

- [ ] 列表页显示封面图
- [ ] 详情页显示封面图
- [ ] 详情页显示介绍插图
- [ ] 图片比例正确
- [ ] 图片加载速度正常

### 库存测试

- [ ] 批量生成库存时使用 ticketsPerHour 值
- [ ] 每个时间段库存数量正确
- [ ] 库存扣减正常
- [ ] 库存不足时无法购买

---

## 九、注意事项

### 1. 图片大小

- 建议单张图片不超过 2MB
- 过大的图片会影响加载速度
- 可以使用图片压缩工具优化

### 2. 图片格式

- 支持：JPG、PNG、GIF
- 推荐：JPG（文件小，质量好）
- 避免：BMP、TIFF（文件太大）

### 3. 门票数量

- 设置时要考虑实际场地容量
- 不要设置过大，避免拥挤
- 可以根据实际情况随时调整

### 4. 介绍插图

- 不是必填项，可以不上传
- 建议至少上传2-3张
- 图片要清晰、美观
- 图片内容要与展览相关

### 5. 数据迁移

- 执行SQL脚本前先备份数据库
- 确认脚本执行成功
- 检查字段是否添加成功

---

## 十、后续优化建议

### 1. 图片上传到服务器

当前使用Base64存储，建议改为：
- 上传到服务器文件系统
- 或上传到OSS（阿里云、腾讯云）
- 返回图片URL存储到数据库

### 2. 图片裁剪

添加图片裁剪功能：
- 确保图片比例正确
- 提升用户体验
- 减少存储空间

### 3. 图片压缩

上传前自动压缩：
- 减少文件大小
- 提升加载速度
- 节省存储空间

### 4. 批量上传

支持一次选择多张图片：
- 提升操作效率
- 减少重复操作

### 5. 图片预览

点击图片查看大图：
- 更好的查看效果
- 支持缩放、旋转

---

## 版本信息

- 修改日期：2026-01-30
- 修改人：Kiro AI
- 版本：v1.4
- 功能：展览表单完整优化（删除详情图、添加门票数量、大图显示）

